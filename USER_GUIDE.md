# ClearVision 用户指南

## 📋 目录

1. [系统要求](#系统要求)
2. [安装说明](#安装说明)
3. [快速入门](#快速入门)
4. [功能详解](#功能详解)
5. [快捷键](#快捷键)
6. [故障排除](#故障排除)
7. [更新日志](#更新日志)

---

## 🖥️ 系统要求

### 最低配置

- **操作系统**: Windows 10 版本 1809 或更高版本（64位）
- **处理器**: Intel Core i3 或同等性能处理器
- **内存**: 4 GB RAM
- **存储空间**: 2 GB 可用空间
- **显示器**: 1366 x 768 分辨率
- **网络**: 互联网连接（用于首次安装依赖）

### 推荐配置

- **操作系统**: Windows 10/11 64位（最新版本）
- **处理器**: Intel Core i5/i7 或 AMD Ryzen 5/7
- **内存**: 8 GB RAM 或更高
- **存储空间**: 5 GB 可用空间（SSD推荐）
- **显示器**: 1920 x 1080 分辨率或更高
- **显卡**: 支持 DirectX 11 的独立显卡
- **网络**: 稳定的互联网连接

### 依赖组件

首次运行时会自动安装以下组件（如未安装）：
- .NET 8.0 Runtime
- Microsoft Edge WebView2 Runtime
- Visual C++ Redistributable

---

## 💾 安装说明

### 方法一：解压即用（推荐）

1. 下载 `ClearVision-x.x.x-win-x64.zip` 文件
2. 解压到任意目录（如 `C:\Program Files\ClearVision`）
3. 运行文件夹中的 `启动 ClearVision.bat` 或直接运行 `Acme.Product.Desktop.exe`
4. 首次启动时会自动安装必要的依赖组件

### 方法二：MSIX 安装

1. 下载 `ClearVision-x.x.x.msix` 文件
2. 双击安装包进行安装
3. 按照提示完成安装向导
4. 从开始菜单启动 ClearVision

### 卸载

- **解压版本**: 直接删除解压目录即可
- **MSIX 版本**: 在"设置 > 应用 > 应用和功能"中找到 ClearVision 并卸载

---

## 🚀 快速入门

### 第一步：创建工程

1. 启动 ClearVision 应用
2. 点击顶部导航栏的"工程"选项卡
3. 点击"新建工程"按钮
4. 输入工程名称和描述
5. 点击"创建"按钮

### 第二步：设计检测流程

1. 切换到"流程"选项卡
2. 从左侧面板拖拽算子到画布：
   - **图像采集**: ImageAcquisition
   - **预处理**: GaussianBlur, Threshold 等
   - **检测算法**: DeepLearning, BlobDetection 等
   - **结果输出**: ResultOutput
3. 连接算子端口（从输出端口拖拽到输入端口）
4. 双击算子设置参数
5. 按 `Ctrl+S` 保存工程

### 第三步：执行检测

1. 切换到"检测"选项卡
2. 导入测试图像或连接相机
3. 点击工具栏的"运行"按钮
4. 查看检测结果和输出图像

### 第四步：查看结果

1. 切换到"结果"选项卡
2. 查看统计信息和检测历史
3. 使用筛选器查看特定状态的结果
4. 导出结果报告（CSV/JSON）

---

## 📖 功能详解

### 1. 流程编辑器

#### 算子库

**图像处理类**
- `ImageAcquisition`: 从相机或文件采集图像
- `GaussianBlur`: 高斯模糊降噪
- `MedianBlur`: 中值滤波
- `Threshold`: 二值化处理
- `CannyEdge`: Canny边缘检测
- `ImageResize`: 图像缩放

**检测算法类**
- `DeepLearning`: 深度学习检测（支持YOLO模型）
- `BlobDetection`: Blob分析
- `FindContours`: 轮廓查找
- `TemplateMatch`: 模板匹配
- `CodeRecognition`: 条码/二维码识别

**测量类**
- `CircleMeasurement`: 圆测量
- `LineMeasurement`: 直线测量
- `MeasureDistance`: 距离测量
- `GeometricTolerance`: 几何公差

**通信类**
- `ModbusCommunication`: Modbus TCP/RTU通信
- `TcpCommunication`: TCP/IP通信
- `DatabaseWrite`: 数据库写入

#### 高级功能

- **撤销/重做**: `Ctrl+Z` / `Ctrl+Y`
- **复制/粘贴**: `Ctrl+C` / `Ctrl+V`
- **框选多节点**: Shift/Ctrl + 点击或拖拽框选
- **删除节点**: Delete 键
- **导入/导出**: 工具栏的"导入"/"导出"按钮
- **自动保存**: 每5分钟自动备份到本地

### 2. 检测功能

#### 单次检测

1. 在"检测"视图中导入图像或配置相机
2. 点击"运行"按钮执行检测
3. 查看处理后的图像和缺陷标记
4. 结果自动保存到数据库

#### 实时检测

1. 确保相机已连接并配置
2. 点击"开始实时检测"
3. 系统将连续采集图像并执行检测
4. 点击"停止实时检测"结束

### 3. 结果管理

#### 统计面板

- **总数**: 检测总次数
- **OK**: 合格次数
- **NG**: 不合格次数
- **良率**: OK占总数的百分比

#### 趋势图

- 显示最近100次检测结果的状态变化
- 绿色: OK
- 红色: NG
- 黄色: Error

#### 筛选与翻页

- 按状态筛选（全部/OK/NG/Error）
- 按时间范围筛选
- 每页显示10条结果
- 支持页码跳转

#### 导出功能

- **CSV格式**: 表格数据，可用Excel打开
- **JSON格式**: 完整数据结构，用于二次开发

### 4. 工程管理

#### 工程列表

- 查看所有工程
- 打开已有工程
- 删除工程
- 导入/导出工程文件

#### 工程文件格式

工程文件使用 `.cvproj.json` 格式：
```json
{
  "version": "1.0",
  "project": {
    "name": "工程名称",
    "flow": { /* 流程数据 */ }
  }
}
```

---

## ⌨️ 快捷键

### 全局快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+S` | 保存工程 |
| `Ctrl+O` | 打开工程 |
| `Ctrl+I` | 导入工程 |
| `Ctrl+E` | 导出工程 |
| `F5` | 运行检测 |
| `F1` | 帮助 |

### 流程编辑器快捷键

| 快捷键 | 功能 |
|--------|------|
| `Ctrl+Z` | 撤销 |
| `Ctrl+Y` | 重做 |
| `Ctrl+C` | 复制选中节点 |
| `Ctrl+V` | 粘贴节点 |
| `Ctrl+A` | 全选节点 |
| `Delete` | 删除选中节点 |
| `Escape` | 取消选择/取消连线 |
| `Shift+点击` | 多选节点 |

---

## 🔧 故障排除

### 启动问题

#### 无法启动，提示缺少 .NET 8

**解决方案**: 下载并安装 [.NET 8.0 Desktop Runtime](https://dotnet.microsoft.com/download/dotnet/8.0)

#### 界面显示异常或白屏

**解决方案**:
1. 确保已安装 Microsoft Edge WebView2 Runtime
2. 尝试重新安装应用
3. 检查显卡驱动是否最新

### 检测问题

#### 深度学习算子加载模型失败

**解决方案**:
1. 确保模型文件格式正确（YOLO格式）
2. 检查模型路径是否正确
3. 确保模型文件未损坏

#### 相机无法连接

**解决方案**:
1. 检查相机电源和数据线连接
2. 确认相机驱动已正确安装
3. 尝试重启相机和应用程序
4. 检查是否有其他程序占用相机

#### 检测结果不准确

**解决方案**:
1. 调整算子参数（阈值、敏感度等）
2. 检查图像预处理效果
3. 更新或重新训练深度学习模型
4. 优化光照条件和相机参数

### 性能问题

#### 检测速度慢

**优化建议**:
1. 降低图像分辨率
2. 减少流程中的算子数量
3. 使用更高效的检测算法
4. 关闭不必要的可视化效果
5. 升级硬件配置

#### 内存占用高

**优化建议**:
1. 定期清理结果历史
2. 减少同时打开的图像数量
3. 重启应用释放内存

### 数据问题

#### 工程文件损坏

**解决方案**:
1. 尝试从自动备份恢复（`cv_autosave_backup`）
2. 使用工程文件的早期版本
3. 手动编辑JSON文件修复

#### 结果数据丢失

**预防措施**:
1. 定期导出结果备份
2. 启用自动保存功能
3. 使用数据库备份功能

---

## 📝 更新日志

### v1.0.0 (2026-02-12)

**新功能**
- ✅ 完整的流程编辑器（撤销/重做、复制/粘贴、框选）
- ✅ 实时检测功能
- ✅ 33个算子（全部迁移到OperatorBase）
- ✅ 通信算子连接池（Modbus/TCP）
- ✅ 检测结果持久化（翻页/筛选/趋势图）
- ✅ 工程导入/导出功能
- ✅ 自动保存功能
- ✅ 深色/浅色主题切换

**优化**
- ✅ 算子执行性能优化
- ✅ 图像处理内存优化
- ✅ 前端UI响应速度优化
- ✅ 日志系统统一

**修复**
- ✅ 流程执行取消机制
- ✅ 缺陷数据提取
- ✅ 图像传递兼容性

---

## 📞 技术支持

如有问题或建议，请通过以下方式联系我们：

- **GitHub Issues**: [提交问题](https://github.com/your-repo/clearvision/issues)
- **邮箱**: support@acme.com
- **文档**: [在线文档](https://docs.acme.com/clearvision)

---

## 📄 许可协议

Copyright © 2026 Acme. All rights reserved.

本软件受版权法和国际版权条约保护。未经授权不得复制、分发或修改。