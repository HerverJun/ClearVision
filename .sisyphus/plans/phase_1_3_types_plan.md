# Phase 1.3: Type Safety Setup - Execution Plan

## Objective
Establish a reliable mechanism to automatically generate TypeScript interfaces from C# DTOs, ensuring frontend-backend type consistency.

## Diagnosis
- **Current Status**: No automatic type generation. Frontend defines types manually (risk of drift).
- **Decision**: Use `TypeGen` (CLI tool) integrated into the build process for simplicity and reliability, as per the initial TODO list. (Source Generators are an alternative but TypeGen is sufficient for DTOs).

## Execution Steps

### Step 1: Setup Local Tool Manifest
- **Command**: `dotnet new tool-manifest` (if not exists)
- **Purpose**: Manage tools locally for the repo.

### Step 2: Install TypeGen Tool
- **Command**: `dotnet tool install dotnet-typegen`
- **Verify**: `dotnet tool run tg --version`

### Step 3: Configure TypeGen
- **File**: `tgconfig.json` (in Solution root)
- **Content**:
  ```json
  {
    "assemblies": [
      "Acme.Product/src/Acme.Product.Application/bin/Debug/net8.0/Acme.Product.Application.dll"
    ],
    "generationSpecs": [
      {
        "modelType": "Acme.Product.Application.DTOs.*",
        "outputDir": "Acme.Product/src/Acme.Product.Desktop/wwwroot/src/types/generated",
        "fileHeader": "// <auto-generated> This file was generated by TypeGen </auto-generated>"
      }
    ]
  }
  ```

### Step 4: Add Build Script
- **File**: `scripts/generate-types.ps1` (or `.sh`)
- **Content**:
  ```powershell
  dotnet build Acme.Product/src/Acme.Product.Application/Acme.Product.Application.csproj
  dotnet tool run tg
  ```

### Step 5: Integration into Project File (Optional but Recommended)
- **File**: `Acme.Product.Desktop.csproj`
- **Action**: Add a `Target` to run TypeGen after build.
  ```xml
  <Target Name="GenerateTypes" AfterTargets="Build">
    <Exec Command="dotnet tool run tg" WorkingDirectory="$(SolutionDir)" IgnoreExitCode="true" />
  </Target>
  ```

## Outcome
- C# DTOs in `Acme.Product.Application.DTOs` are mirrored as TypeScript interfaces in `wwwroot/src/types/generated`.
- Build process ensures they stay in sync.
